syntax = "proto3";
package rpc.transmission;
option go_package = "QuickStone/src/rpc/transmission";

message UploadObjectRequestHeader {
    uint32 target_user_id = 1;       // 定位到要将对象上传到哪个用户的存储资源下
    string bucket = 2;
    string key = 3;
    string object_type = 4;
    uint64 object_size = 5;
}

message UploadObjectRequestBody {
    uint32 series_no = 1;
    bytes data = 2;
}

message UploadObjectRequestChunk {
    oneof payload {
        UploadObjectRequestHeader header = 1;
        UploadObjectRequestBody data = 2;
    }
}

message UploadObjectResponse {
    uint32 status_code = 1;
    string status_msg = 2;
}

message DownloadObjectRequest {
    uint32 target_user_id = 1;
    string bucket = 2;
    string key = 3;
}

message DownloadObjectResponse {
    uint32 status_code = 1;
    string status_msg = 2;
    bytes object = 3;
}

service TransmissionService {
    rpc UploadObject(stream UploadObjectRequestChunk) returns(UploadObjectResponse);
    rpc DownloadObject(DownloadObjectRequest) returns(DownloadObjectResponse);
}